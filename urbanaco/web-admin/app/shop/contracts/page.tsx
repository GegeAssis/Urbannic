'use client'; import {useEffect,useState} from 'react'; import api from '@/lib/api'; export default function Page(){ const [c,setC]=useState<any[]>([]); const [bikes,setB]=useState<any[]>([]); const [cour,setCour]=useState('Courier Demo'); const [bike,setBike]=useState(''); const [price,setPrice]=useState(30000); const [mode,setMode]=useState<'RENTAL'|'PURCHASE'>('RENTAL'); const reload=async()=>{ const [cc,bb]=await Promise.all([api.get('/contracts'), api.get('/bikes')]); setC(cc.data); setB(bb.data); }; useEffect(()=>{reload()},[]); return(<div className='card'><h1>Contratos</h1><div className='my-2'><input className='btn' value={cour} onChange={e=>setCour(e.target.value)}/> <select className='btn' value={bike} onChange={e=>setBike(e.target.value)}><option value=''>Bike...</option>{bikes.filter((x:any)=>x.status==='AVAILABLE').map((x:any)=><option key={x.id} value={x.id}>{x.id} — {x.model}</option>)}</select> <input className='btn' type='number' value={price} onChange={e=>setPrice(parseInt(e.target.value||'0'))}/> <select className='btn' value={mode} onChange={e=>setMode(e.target.value as any)}><option value='RENTAL'>Aluguel</option><option value='PURCHASE'>Compra</option></select> <button className='btn' onClick={async()=>{await api.post('/contracts/courier',{ courierName:cour, bikeId:bike, priceCents:price, mode }); reload();}}>Criar p/ Courier</button></div><ul>{c.map(x=><li key={x.id}>{x.id} — {x.status} — {x.type} <button className='btn' onClick={async()=>{await api.post(`/contracts/${x.id}/terminate`); reload();}}>Encerrar</button></li>)}</ul></div>)}
