'use client'; import {useEffect,useState} from 'react'; import api from '@/lib/api'; export default function Page(){ const [f,setF]=useState<any[]>([]); const [name,setName]=useState('Frota A'); const [bikes,setBikes]=useState<any[]>([]); const [selected,setSel]=useState(''); const reload=async()=>{const r=await api.get('/fleets'); setF(r.data); const b=await api.get('/bikes'); setBikes(b.data)}; useEffect(()=>{reload()},[]); return(<div className='card'><h1>Frotas</h1><div className='my-2'><input className='btn' value={name} onChange={e=>setName(e.target.value)} /> <button className='btn' onClick={async()=>{await api.post('/fleets',{name}); reload()}}>Criar</button></div>{f.map(fl=>(<div key={fl.id} className='card my-2'><div>{fl.name}</div><div><select className='btn' value={selected} onChange={e=>setSel(e.target.value)}><option value=''>Selecione uma bike</option>{bikes.filter((b:any)=>b.status==='AVAILABLE').map((b:any)=><option key={b.id} value={b.id}>{b.id} — {b.model}</option>)}</select> <button className='btn' onClick={async()=>{if(selected) await api.post(`/fleets/${fl.id}/add-bike`,{bikeId:selected}); reload()}}>Adicionar bike</button></div><div>Bikes: {fl.bikes?.length?fl.bikes.join(', '):'—'}</div></div>))}</div>)}
